<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Application</title>
</head>

<body>
    <div id="letra">
    </div>
    
    <div id="jogadores">
    </div>

    <div id="jogadores-aguardando">
    </div>

    <table>
        <thead>
            <tr>
                <th>Nome</th>
                <th>Fruta</th>
                <th>Cor</th>
            </tr>
        </thead>
            <tr>
                <td><input type="text" name="nome" id="nome" disabled></td>
                <td><input type="text" name="fruta" id="fruta" disabled></td>
                <td><input type="text" name="cor" id="cor" disabled></td>
            </tr>
        <tbody>

        </tbody>
    </table>

    <div>
        <button id="stop" disabled>Stop</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();
        
        const $jogadores = document.querySelector('#jogadores');
        const $jogadoresAguardando = document.querySelector('#jogadores-aguardando');
        const $letra = document.querySelector('#letra');
        const $nome = document.querySelector('#nome');
        const $fruta = document.querySelector('#fruta');
        const $cor = document.querySelector('#cor');
        const $stop = document.querySelector('#stop');

      
        socket.on('server_timer', (data) => {
            console.log('server_timer', data);

            $letra.innerHTML = `Letra ${data.letter}`;
            $jogadores.innerHTML = `Jogadores: ${data.players.join(', ')}`;
            $jogadoresAguardando.innerHTML = `Jogadores aguardando: ${data.playersWaiting.join(', ')}`;
        });

        socket.on('new_match', (data) => {
            $nome.value = '';
            $fruta.value = '';
            $cor.value = '';
            $letra.innerHTML = `Letra ${data.letter}`;

            $nome.disabled = false;
            $fruta.disabled = false;
            $cor.disabled = false;
            $stop.disabled = false;

            console.log('new_match', data);
        });

        socket.on('current_match', (data) => {
            $letra.innerHTML = `Letra ${data.letter}`;
            console.log('current_match', data);
        });


        $stop.addEventListener('click', (e) => {
            socket.emit('stop');
        });

        const sendWords = () => {
            var nome = $nome.value;
            var fruta = $fruta.value;
            var cor = $cor.value;

            socket.emit('sending_words', {
                nome,
                fruta,
                cor
            });
        }

        $nome.addEventListener('input', sendWords);
        $fruta.addEventListener('input', sendWords);
        $cor.addEventListener('input', sendWords);
    </script>
</body>

</html>